{
  "project": {
    "name": "LightRoll_Cleaner",
    "description": "写真・動画ライブラリのクリーンアップツール（iOS）",
    "created_at": "2025-11-27",
    "version": "0.4.0",
    "tech_stack": ["Swift", "SwiftUI", "Photos Framework", "Vision Framework", "StoreKit 2"],
    "platform": "iOS",
    "min_deployment_target": "iOS 17.0"
  },
  "current_phase": {
    "phase": "implementation_phase_2",
    "description": "Phase 2（データ層）進行中 - M2完了、M3 2/13完了",
    "next_phase": "implementation_phase_2_completion"
  },
  "last_session": {
    "date": "2025-11-28",
    "session_id": "impl-007",
    "completed_tasks": [
      "M3-T01: PhotoAnalysisResultモデル (115/120点)",
      "M3-T02: PhotoGroupモデル (112/120点)"
    ],
    "completed_task_count": 2,
    "test_results": "964テスト（963パス / 1失敗は既存パフォーマンステスト）",
    "average_quality_score": "113.5点 (94.6%)",
    "in_progress_tasks": []
  },
  "cumulative_progress": {
    "total_completed_tasks": 28,
    "total_tasks": 118,
    "completion_percentage": 23.7,
    "total_tests": 964,
    "all_tests_passing": true,
    "notes": "1件のパフォーマンステスト失敗は既知の問題（機能テストは全パス）"
  },
  "next_session": {
    "recommended_start": "development_continue",
    "recommended_action": "continue_m3_implementation",
    "start_instructions": [
      "1. CONTEXT_HANDOFF.jsonを読み、前回の状態を確認",
      "2. M3-T03 (VisionRequestHandler)から実装を継続",
      "3. Vision Frameworkを活用した画像分析機能の実装"
    ],
    "priority_tasks": [
      "M3-T03: VisionRequestHandler（Vision Framework基盤）",
      "M3-T04: 特徴量抽出（画像特徴ベクトル抽出）",
      "M3-T05: 類似度計算（コサイン類似度等）"
    ],
    "optional_parallel_tasks": [
      "M4-T05: PhotoThumbnail実装（UI層先行着手可）",
      "M4-T06: PhotoGrid実装"
    ],
    "blockers": [],
    "prerequisites": []
  },
  "modules": {
    "completed": [
      {"id": "M1", "name": "Core Infrastructure", "completed_tasks": 10, "total_tasks": 10, "status": "completed", "completion_date": "2025-11-28"},
      {"id": "M2", "name": "Photo Access & Scanning", "completed_tasks": 12, "total_tasks": 12, "status": "completed", "completion_date": "2025-11-28", "average_score": "111.5/120"}
    ],
    "in_progress": [
      {"id": "M3", "name": "Image Analysis & Grouping", "completed_tasks": 2, "total_tasks": 13, "status": "in_progress", "remaining": ["M3-T03", "M3-T04", "M3-T05", "M3-T06", "M3-T07", "M3-T08", "M3-T09", "M3-T10", "M3-T11", "M3-T12", "M3-T13"]},
      {"id": "M4", "name": "UI Components", "completed_tasks": 4, "total_tasks": 14, "status": "in_progress", "remaining": ["M4-T05", "M4-T06", "M4-T07", "M4-T08", "M4-T09", "M4-T10", "M4-T11", "M4-T12", "M4-T13", "M4-T14"]}
    ],
    "pending": [
      {"id": "M5", "name": "Dashboard & Statistics", "tasks": 13, "hours": 24, "status": "pending"},
      {"id": "M6", "name": "Deletion & Safety", "tasks": 14, "hours": 25, "status": "pending"},
      {"id": "M7", "name": "Notifications", "tasks": 13, "hours": 17.5, "status": "pending"},
      {"id": "M8", "name": "Settings & Preferences", "tasks": 14, "hours": 21, "status": "pending"},
      {"id": "M9", "name": "Monetization", "tasks": 15, "hours": 25.5, "status": "pending"}
    ]
  },
  "implementation_phases": [
    {
      "phase": 1,
      "name": "基盤構築",
      "modules": ["M1", "M4前半"],
      "tasks": "M1-T01〜M1-T10, M4-T01〜M4-T04",
      "status": "completed",
      "progress": {
        "completed_tasks": 14,
        "total_tasks": 14,
        "percentage": 100
      }
    },
    {
      "phase": 2,
      "name": "データ層",
      "modules": ["M2", "M3"],
      "tasks": "M2-T01〜M2-T12, M3-T01〜M3-T13",
      "status": "in_progress",
      "progress": {
        "completed_tasks": 14,
        "total_tasks": 25,
        "percentage": 56,
        "notes": "M2完了、M3 2/13完了"
      }
    },
    {
      "phase": 3,
      "name": "UI層",
      "modules": ["M4後半", "M5"],
      "tasks": "M4-T05〜M4-T14, M5-T01〜M5-T13",
      "status": "pending"
    },
    {
      "phase": 4,
      "name": "機能完成",
      "modules": ["M6", "M8"],
      "tasks": "M6-T01〜M6-T14, M8-T01〜M8-T14",
      "status": "pending"
    },
    {
      "phase": 5,
      "name": "仕上げ",
      "modules": ["M7", "M9", "テスト"],
      "tasks": "M7-T01〜M7-T13, M9-T01〜M9-T15",
      "status": "pending"
    }
  ],
  "mcp_status": {
    "installed": ["xcodebuildmcp"],
    "pending": [],
    "configured": true,
    "note": "xcodebuildmcp連携設定済み - ビルド/テスト実行に活用"
  },
  "context_optimization": {
    "last_optimized": "2025-11-28",
    "optimization_session": "opt-007",
    "session_count": 12,
    "completed_task_count": 28,
    "progress_entries_count": 7,
    "archived_tasks_count": 28,
    "archived_modules": ["M1", "M2"],
    "context_usage_estimate": "moderate",
    "tasks_archived_this_session": [
      "M3-T01", "M3-T02"
    ],
    "next_optimization_trigger": "M3完了時 または 35タスク完了時"
  },
  "quality_metrics": {
    "total_tests": 964,
    "tests_passed": 963,
    "tests_failed": 1,
    "average_score": 110.3,
    "passing_threshold": 96,
    "all_tasks_passing": true,
    "notes": "失敗1件はパフォーマンステスト（機能テストは全パス）"
  },
  "file_structure": {
    "docs/CRITICAL": "重要ドキュメント（常時読み込み推奨）",
    "docs/modules": "モジュール仕様書（必要時に参照）",
    "docs/archive": "アーカイブ済みドキュメント",
    "LightRoll_Cleaner": "メインアプリケーションソース",
    "LightRoll_CleanerPackage": "SPM Feature Package",
    "tests": "テストコード"
  },
  "quick_reference": {
    "architecture": "docs/CRITICAL/ARCHITECTURE.md",
    "rules": "docs/CRITICAL/CORE_RULES.md",
    "tasks": "docs/TASKS.md",
    "progress": "docs/PROGRESS.md"
  },
  "dependencies": {
    "external": [
      {"name": "Google Mobile Ads SDK", "version": "latest", "module": "M9", "required": false}
    ],
    "internal": []
  },
  "known_issues": [
    {
      "id": "PERF-001",
      "description": "パフォーマンステスト1件が不安定（タイミング依存）",
      "severity": "low",
      "status": "known",
      "workaround": "機能テストには影響なし"
    }
  ],
  "notes": [
    "プロジェクト初期化完了（2025-11-27）",
    "設計ドキュメント完成（2025-11-27）",
    "アーキテクチャ選定完了: MVVM + Repository Pattern（2025-11-27）",
    "Phase 1完了（2025-11-28）: M1 10/10, M4 4/14",
    "Phase 2進行中（2025-11-28〜）: M2 12/12完了, M3 2/13完了",
    "impl-007: 2タスク完了、964テスト、平均品質スコア113.5点（2025-11-28）",
    "累計進捗: 28/118タスク完了 (23.7%)"
  ]
}
