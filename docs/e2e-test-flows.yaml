# LightRoll Cleaner E2E Test Flows
# Generated: 2024-12-21
# Framework: Maestro (YAML format)
# Note: Core ML features require physical device for full testing

appId: com.lightroll.cleaner
---

# =============================================================================
# Test Flow 1: Happy Path - Home Screen Display
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner
    clearState: true

- assertVisible:
    text: "ホーム"

- assertVisible:
    text: "ストレージ概要"

- assertVisible:
    text: "スキャン"

- assertVisible:
    text: "グループ"

- takeScreenshot: "01_home_screen"

---

# =============================================================================
# Test Flow 2: Settings Screen Navigation
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner

- tapOn:
    id: "gearshape"

- assertVisible:
    text: "設定"

- assertVisible:
    text: "プレミアムにアップグレード"

- assertVisible:
    text: "スキャン設定"

- assertVisible:
    text: "自動スキャン"

- assertVisible:
    text: "動画を含める"

- assertVisible:
    text: "スクリーンショットを含める"

- assertVisible:
    text: "分析設定"

- assertVisible:
    text: "類似度しきい値"

- takeScreenshot: "02_settings_screen"

---

# =============================================================================
# Test Flow 3: Settings Toggle Interaction
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner

- tapOn:
    id: "gearshape"

# Toggle auto scan on
- tapOn:
    text: "自動スキャン"
    index: 0

- assertVisible:
    text: "スキャン間隔"

- takeScreenshot: "03_auto_scan_enabled"

# Toggle auto scan off
- tapOn:
    text: "自動スキャン"
    index: 0

---

# =============================================================================
# Test Flow 4: Scan Button Tap (Simulator - Expected Error)
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner
    clearState: true

- tapOn:
    text: "スキャン"

# On simulator, Core ML will fail - verify error dialog appears
- assertVisible:
    text: "エラー"
    optional: true

- assertVisible:
    text: "OK"
    optional: true

- tapOn:
    text: "OK"
    optional: true

- takeScreenshot: "04_scan_error_handled"

---

# =============================================================================
# Test Flow 5: Storage Overview Card Display
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner

- assertVisible:
    id: "StorageOverviewCard"

- assertVisible:
    text: "使用中"

- assertVisible:
    text: "空き容量"

- assertVisible:
    text: "写真ライブラリ"

- takeScreenshot: "05_storage_overview"

---

# =============================================================================
# Test Flow 6: Photo Library Permission (First Launch)
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner
    clearState: true

# Check for permission dialog
- assertVisible:
    text: "写真ライブラリにアクセス"
    optional: true

- tapOn:
    text: "フルアクセスを許可"
    optional: true

- takeScreenshot: "06_permission_granted"

---

# =============================================================================
# Test Flow 7: Error Recovery - Permission Denied State
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner

# If permission denied, error state should show
- assertVisible:
    text: "エラーが発生しました"
    optional: true

- assertVisible:
    text: "再読み込み"
    optional: true

- tapOn:
    text: "再読み込み"
    optional: true

- takeScreenshot: "07_error_recovery"

---

# =============================================================================
# Test Flow 8: Quick Actions Accessibility
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner

- assertVisible:
    text: "クイックアクション"

# Verify scan button is enabled
- assertVisible:
    text: "スキャン, プライマリボタン"
    enabled: true

# Verify group button is disabled before scan
- assertVisible:
    text: "グループ"

- takeScreenshot: "08_quick_actions"

---

# =============================================================================
# Test Flow 9: Premium Upgrade Banner
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner

- tapOn:
    id: "gearshape"

- assertVisible:
    text: "プレミアムにアップグレード"

- assertVisible:
    text: "すべての機能を解放"

- tapOn:
    text: "プレミアムにアップグレード"

- takeScreenshot: "09_premium_banner"

---

# =============================================================================
# Test Flow 10: Analysis Settings Verification
# =============================================================================
- launchApp:
    appId: com.lightroll.cleaner

- tapOn:
    id: "gearshape"

# Scroll to analysis settings
- scroll:
    direction: DOWN

- assertVisible:
    text: "分析設定"

- assertVisible:
    text: "類似度しきい値"

- assertVisible:
    text: "85%"

- assertVisible:
    text: "ブレ判定感度"

- assertVisible:
    text: "標準"

- assertVisible:
    text: "最小グループサイズ"

- assertVisible:
    text: "2枚"

- takeScreenshot: "10_analysis_settings"
