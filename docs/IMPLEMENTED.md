# 実装済み機能一覧

このファイルは、ユーザー視点で「できるようになったこと」を記録します。

---

## 現在の実装状況

### バージョン: 0.9.0（Phase 2 画像分析 進行中）

**アプリ機能**: 類似写真のグループ検出に加え、顔検出機能が完成。セルフィー（自撮り写真）を自動識別し、顔の角度や位置情報も取得可能に。3つの検出感度プリセット（標準/厳格/緩和）により、ユーザーのニーズに合わせた写真整理が可能。

---

## Version 0.9.0 (2025-11-28) - 顔検出機能

### セルフィー（自撮り写真）の自動識別
- **顔を自動検出**: Vision Frameworkによる高精度な顔検出機能
- **セルフィー判定アルゴリズム**: 顔のサイズ比率（15%閾値）によるセルフィー自動判定
- **顔の詳細情報取得**: 位置、角度（yaw/pitch/roll）、信頼度を取得
- **3つの検出感度プリセット**: default（閾値0.15）、strict（0.20）、relaxed（0.10）

**技術的成果**:
- FaceDetector: 顔検出サービス（525行、actor実装）
- FaceInfo: 顔情報モデル（バウンディングボックス、角度、信頼度）
- FaceDetectionOptions: 検出感度プリセット（3種類）
- VNDetectFaceRectanglesRequest統合
- 40テストケース、品質スコア: 113/120点

---

## Version 0.8.0 (2025-11-28) - 類似写真グループ検出機能

### 類似写真の自動グループ化
- **連写・バースト写真を自動検出**: 同じシーンで撮った写真をAIが自動的にグループ化
- **3つの検出感度プリセット**: 標準（85%類似度）、厳格（95%）、緩和（75%）で用途に合わせた検出
- **高速グループ化**: Union-Findアルゴリズムによる効率的なクラスタリング処理

**技術的成果**:
- SimilarityAnalyzer: 類似写真グループ検出エンジン（actor実装）
- SimilarPhotoGroup: グループ情報モデル（平均類似度、ペア数等）
- SimilarityAnalysisOptions: 検出感度プリセット（default/strict/relaxed）
- UnionFind: 効率的なグラフクラスタリングデータ構造
- 27テストケース追加、品質スコア: 108/120点

---

## Version 0.7.0 (2025-11-28) - Vision Framework基盤完成

### 画像解析基盤
- 写真の特徴量を自動抽出し、類似写真を検出する基盤が完成
- Vision Frameworkを活用した高精度な画像解析機能
- バッチ処理による高速な大量写真の処理が可能に

**技術的成果**:
- VisionRequestHandler: Vision Frameworkの統括管理（actor実装）
- FeaturePrintExtractor: 画像特徴量抽出サービス（並列処理対応）
- SimilarityCalculator: コサイン類似度計算エンジン（マトリクス生成）
- 62テストケース追加、品質スコア: 106/120点

---

## 完了モジュール

### M2: Photo Access & Scanning - 完了（2025-11-28）

**ユーザー視点でできるようになったこと**:
- 写真ライブラリへのアクセス権限をリクエストできる
- デバイス内の全ての写真・動画を一覧で確認できる
- 写真のサムネイルが高速に表示される（キャッシュ機能付き）
- デバイスのストレージ使用量を確認できる
- アプリをバックグラウンドにしていても写真ライブラリの変更を検知

### M1: Core Infrastructure - 完了（2025-11-28）

**ユーザー視点でできるようになったこと**:
- アプリ全体で統一されたログ出力とパフォーマンス計測が可能
- 開発効率化のための豊富なユーティリティ関数（100以上）が利用可能
- エラーハンドリングと設定管理の基盤が完成し、堅牢なアプリ動作を実現

---

## 進行中モジュール

### M3: Image Analysis & Grouping - 進行中（7/13タスク, 54%）

**ユーザー視点でできるようになること**:
- **実装済み**: 類似写真を自動でグループ化（連写した写真をまとめて整理）
- **実装済み**: セルフィー（自撮り写真）を自動識別（顔検出による判定）
- 準備中: 写真の品質を自動評価（ブレ、明るすぎ/暗すぎを検出）
- 準備中: ベストショットの自動選定（グループ内で最も良い1枚を推薦）
- 準備中: 削除候補の自動提案（低品質な写真を特定し容量節約を支援）

**完了コンポーネント**:
- PhotoAnalysisResult: 12種類の分析指標（品質、ブレ、明るさ、顔検出等）
- PhotoGroup: 6種類のグルーピング（類似、自撮り、スクショ、ブレ、動画、重複）
- VisionRequestHandler: Vision Framework統括管理クラス
- FeaturePrintExtractor: 画像特徴量抽出サービス
- SimilarityCalculator: コサイン類似度計算エンジン
- SimilarityAnalyzer: 類似写真グループ検出エンジン（Union-Find, 3プリセット）
- **FaceDetector**: 顔検出サービス（VNDetectFaceRectanglesRequest、セルフィー判定）

### M4: UI Components - 部分完了（4/14タスク）

**ユーザー視点でできるようになったこと**:
- デザインシステム基盤が完成し、一貫したUIスタイルでの開発が可能
- グラスモーフィズム効果を使った美しいカードやボタンが実装可能
- Dynamic Type完全対応で、アクセシビリティ設定に追従するフォント

---

## ユーザー視点での進捗サマリー

| 観点 | 状態 | 説明 |
|------|------|------|
| アプリ起動 | **基盤完成** | Core基盤完了、デザインシステム適用準備完了 |
| 写真スキャン | **実装完了** | Photos Framework統合、バックグラウンドスキャン対応 |
| 類似写真検出 | **実装完了** | SimilarityAnalyzerによるグループ検出機能完成 |
| セルフィー検出 | **実装完了** | FaceDetectorによる顔検出・セルフィー判定機能完成 |
| 写真グルーピング | **基盤完成** | 6種類のグループタイプ定義完了 |
| 一括削除 | 設計完了 | 安全な削除フローを仕様化済み |
| 容量表示 | 設計完了 | ダッシュボードUI設計済み |
| 課金機能 | 設計完了 | StoreKit 2統合の仕様策定済み |

---

## 次回実装予定

### Phase 2 継続 - 画像分析エンジン（M3: Image Analysis）
- [x] M3-T01: PhotoAnalysisResultモデル（完了）
- [x] M3-T02: PhotoGroupモデル（完了）
- [x] M3-T03: VisionRequestHandler（完了）
- [x] M3-T04: 特徴量抽出（完了）
- [x] M3-T05: 類似度計算（完了）
- [x] M3-T06: SimilarityAnalyzer（完了）
- [x] M3-T07: 顔検出（完了）
- [ ] M3-T08〜T09: 各種分析器（ブレ、スクショ）
- [ ] M3-T10〜T13: グルーパー、ベストショット、統合、テスト

### Phase 3 - UI層（M4後半）
- [ ] M4-T05〜T08: 共通コンポーネント（サムネイル、グリッド、カード）
- [ ] M4-T09〜T14: インタラクション要素（ボタン、ダイアログ、トースト）

---

## 機能リリース履歴

| バージョン | リリース日 | 主な機能 |
|-----------|-----------|----------|
| 0.1.0 | 2025-11-27 | 設計フェーズ完了 |
| 0.2.0 | 2025-11-28 | 基盤構築開始（Core + カラーパレット） |
| 0.3.0 | 2025-11-28 | デザインシステム基盤完成（Typography + Glass + Spacing + Protocols） |
| 0.4.0 | 2025-11-28 | M1: Core Infrastructure完了（Logger + Extensions + Tests） |
| 0.5.0 | 2025-11-28 | M2: Photo Access完了（Photos Framework + Background Scan + Cache） |
| 0.6.0 | 2025-11-28 | M3: Image Analysis基盤（PhotoAnalysisResult + PhotoGroup） |
| 0.7.0 | 2025-11-28 | M3: Vision Framework基盤（VisionRequestHandler + FeaturePrintExtractor + SimilarityCalculator） |
| 0.8.0 | 2025-11-28 | M3: 類似写真グループ検出（SimilarityAnalyzer + Union-Findクラスタリング） |
| 0.9.0 | 2025-11-28 | M3: 顔検出機能（FaceDetector + セルフィー判定アルゴリズム） |
| 1.0.0 | 予定 | 初回リリース（MVP） |

---

*最終更新: 2025-11-28 (impl-010)*
